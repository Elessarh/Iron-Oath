<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Profil - Iron Oath</title>
    <link rel="icon" type="image/png" href="../assets/Logo_3.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=Exo+2:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css?v=mobile-fix-006">
    <link rel="stylesheet" href="../css/components/profil.css">
    
    <!-- Script anti-flash immÃ©diat -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const userInfo = document.getElementById('user-info');
            if (userInfo) {
                userInfo.style.display = 'none';
                userInfo.classList.remove('show');
                userInfo.classList.remove('js-visible');
            }
        });
    </script>
</head>
<body class="profil-page">
    <!-- Header et Navigation -->
    <header class="header">
        <nav class="nav-container">
            <div class="nav-logo-container">
                <img src="../assets/Logo_3.png" alt="Iron Oath Logo" class="nav-logo-safe">
            </div>
            <ul class="nav-menu" id="nav-menu">
                <li><a href="../index.html" class="nav-link">Accueil</a></li>
                <li><a href="map.html" class="nav-link">Carte</a></li>
                <li><a href="bestiaire.html" class="nav-link">Bestiaire</a></li>
                <li><a href="items.html" class="nav-link">Items</a></li>
                <li><a href="hdv.html" class="nav-link">HDV</a></li>
                <li><a href="quetes.html" class="nav-link">QuÃªtes</a></li>
            </ul>
            <div class="nav-connexion">
                <span id="user-info" class="user-info" style="display: none;">
                    <a href="profil.html" id="username" class="username-link"></a>
                    <button id="logout-btn" class="logout-btn">DÃ©connexion</button>
                </span>
                <a href="connexion.html" class="connexion-link" id="login-link">Connexion</a>
            </div>
            <button class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </nav>
    </header>

    <!-- Contenu principal -->
    <main class="profil-container">
        <div id="loading" class="loading-spinner">
            <p>â³ Chargement de votre profil...</p>
        </div>
        
        <div id="profil-content" style="display: none;">
            <div class="profil-header">
                <h1>Mon Profil</h1>
                <!-- Bouton Dashboard pour admins uniquement -->
                <a href="admin-dashboard.html" id="dashboard-btn" class="dashboard-btn" style="display: none;">
                    ðŸ›¡ï¸ AccÃ©der au Dashboard Admin
                </a>
                <!-- Bouton Guilde pour membres et admins -->
                <a href="espace-guilde.html" id="guilde-btn" class="dashboard-btn" style="display: none;">
                    ðŸ›ï¸ Espace Iron Oath
                </a>
            </div>
            
            <div class="profil-info">
                <div class="info-row">
                    <span class="info-label">ðŸ‘¤ Pseudo Joueur</span>
                    <span class="info-value" id="profile-username">-</span>
                </div>
                
                <div class="info-row">
                    <span class="info-label">ðŸ“§ Email</span>
                    <span class="info-value" id="profile-email">-</span>
                </div>
                
                <div class="info-row">
                    <span class="info-label">ðŸŽ–ï¸ RÃ´le</span>
                    <span class="info-value">
                        <span id="profile-role" class="role-badge role-joueur">Joueur</span>
                    </span>
                </div>
                
                <div class="info-row">
                    <span class="info-label">âš”ï¸ Classe</span>
                    <span class="info-value">
                        <select id="profile-classe" class="profile-select">
                            <option value="Shaman">Shaman</option>
                            <option value="Mage">Mage</option>
                            <option value="Assassin">Assassin</option>
                            <option value="Guerrier" selected>Guerrier</option>
                            <option value="Archer">Archer</option>
                        </select>
                    </span>
                </div>
                
                <div class="info-row">
                    <span class="info-label">ðŸ”¢ Niveau</span>
                    <span class="info-value">
                        <input type="number" id="profile-niveau" class="profile-input" min="1" max="100" value="1">
                    </span>
                </div>
                
                <div class="info-row">
                    <span class="info-label">ðŸ“… Membre depuis</span>
                    <span class="info-value" id="profile-created">-</span>
                </div>
                
                <div class="info-row" style="justify-content: center; margin-top: 20px;">
                    <button id="save-profile-btn" class="save-profile-btn">ðŸ’¾ Sauvegarder les modifications</button>
                </div>
            </div>
            
            <div class="profil-stats">
                <div class="stat-card">
                    <div class="stat-label">Messages EnvoyÃ©s</div>
                    <div class="stat-value" id="stat-messages">0</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">Items PossÃ©dÃ©s</div>
                    <div class="stat-value" id="stat-items">0</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-label">Niveau</div>
                    <div class="stat-value" id="stat-level">1</div>
                </div>
            </div>
        </div>
        
        <div id="error-content" class="error-message" style="display: none;">
            <h2>âš ï¸ Erreur</h2>
            <p id="error-text">Une erreur est survenue lors du chargement du profil.</p>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2024 Iron Oath. Tous droits rÃ©servÃ©s.</p>
    </footer>

    <!-- Scripts -->
    <!-- Chargement Supabase via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
    
    <script src="../js/config.js"></script>
    <script src="../js/performance-monitor.js"></script>
    <script src="../js/cache-manager.js" defer></script>
    <script src="../js/navbar-mobile.js" defer></script>
    <script src="../js/auth-supabase.js"></script>
    <script src="../js/profil.js" defer></script>
</body>
</html>
